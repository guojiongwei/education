(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-631fc218"],{"06f1":function(e,t,i){"use strict";var s=i("2d74"),n=i.n(s);n.a},"0fc2":function(e,t,i){"use strict";var s=i("bbf1"),n=i.n(s);n.a},"20ac":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAABUCAYAAAAlDKGaAAAD10lEQVR4Xu3cUUgTcRwH8O/frBWRRSCCSBIZST1UVNgUCSl7EOnBCkJ68SV8sl5y5lNC6OZzRO/5EIQSVAYlGFgqpG5laoailmgzJbUMF9TFfzZZ29p+t93N3d1vDz7M7/3v/p/77rw79QQAKM3X90NJc0IRZyCQId8z3EvgEVZsF0RDw089tl0ortoDgOgFxC49VpC0MdPTgWOFHkx47aKqalXr9QrF5WgFRIXWAyd9vPTNwOlyYHFBFyyhOOuWDPtxC94bASj53tcFDya1bZZQXHVK0ve+HisMhgpgDY6dFDU1Pi1WZ14oP9a8G4Pjdi2wzA2lIZb5oSTWwpwbQxMJNcsaUBpgWQdKYs3PuTEcX7OsBeXH8roxPKn6Y2g9qDixrAklsb54BzAyWUg9dbAulB/r8wBGpkhY1oYKYL0csMe668BQEmtuth+v3IXRsBgqcCEYA4uhgq+YvTP96PZEbBZDhd5a8M70odtTFPoxNA8UBFB6DkhLS/yuSgQsE0EBOFIAZGUnDiVHmJ3uQ+/b9WaZC2rbdqDgFGCzaYM189Ejyi4elYOZC0rOyLYV2JcP7M4EtmgAdryoVAjRYT4obbq0PopwOIU5G8VQGgsQh+NGMRRRgBjjRjEUUYAY40YxFFGAGONGpTRUZTWQk0vcxKCYzwcsLwKfJoDuDuDHivox4lxiYxoVL1ToJKengIf3kgJmbCgJJ1v25AEwNhRnV2iLGR8qMM+2Fl2xUgdqfBR40f7/3Zu9B8jNW7t1Euk+0/IScNdJq0ccqdSBGn4DPL5Pm0LVNSAzKzzb0wl0PaONoTJlTCg5yeo6IGPnv9PVsVXGhTpRDJSUhffi9i1dfgoaF0oS1TaFQz1tBQb7VH6wYseNDXX1ZviBvbMdeN0Ve+YqE8aGitQohgqpQM5eoPJKeC90Op8ybqPKLwEHD/PBPOohJO8QUHE5PMKnB0EmxWcBe0lkR0uccMqL21ivaL8i17FNcrNS5xgVCyna9yVyyx35nwmJjBJ1WeNDJQHJ+I1ScyGdYNdSp1GUY5RvVf6pM/DhnS6XKdEsUwcqie2Ip1wMRVRjKIYiChBj3CiGIgoQY9wohiIKEGPcKIYiChBj3CiGIgoQYxvTKOLGpVKMoYh7g6EYiihAjHGjGIooQIxxoxiKKECMcaMYiihAjHGjGIooQIxxoxiKKECMcaNUQ5nlocrEiauMfRcO5w65jHke061SgBZX2oTDdX4NqvFGPjb97jH8g99pM1eRUhbxK80u6pve+6Hkl79PyW8ERCkAf9Us/PoGKM8BpV44mkcDDn8Aa3Kecxtm2akAAAAASUVORK5CYII="},"2d74":function(e,t,i){},3136:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"index-page"},[s("div",{staticClass:"page-left"},[s("div",{staticClass:"person-info"},[e._m(0),s("div",{staticClass:"info"},[s("div",{staticClass:"info-top"},[s("div",{staticClass:"info-box"},[s("p",{staticClass:"name"},[e._v(e._s(e.myInfo.userName||e.myInfo.nickName||""))]),s("p",{staticClass:"employ-no"},[e._v("工号："+e._s(e.topUserInfo.loginName))])]),s("div",{staticClass:"select-person"},[s("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),s("div",{staticClass:"info-bottom"},[s("div",{staticClass:"person-handle",on:{click:e.addFriend}},[s("i",{staticClass:"iconfont iconicon_add_friend1"}),s("span",[e._v("添加好友")])]),e._m(1)])])]),s("div",{staticClass:"search-box"},[s("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入内容"},model:{value:e.searchUser,callback:function(t){e.searchUser=t},expression:"searchUser"}},[s("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("div",{staticClass:"session-list"},e._l(e.sessionList,(function(t){return s("div",{key:t.gorupId,ref:"messageList",refInFor:!0,on:{click:function(i){return e.changeCurrSessionItem(t)}}},[s("SessionItem",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!item.show"}],attrs:{item:t}})],1)})),0)]),s("div",{staticClass:"page-center-box"},[e.$store.state.currSessionId||e.isUpdateScroll>0?s("div",{staticClass:"page-center"},[s("div",{staticClass:"session-title"},[s("span",{staticClass:"nick-name ellipsis"},[e._v(e._s(e.currGroupChatInfo.groupName))]),s("div",{staticClass:"wechat-name"},[0==e.wechatInfo.type&&e.wechatInfo.clientInfo.membersName?s("span",{staticClass:"ellipsis",attrs:{title:e.wechatInfo.clientInfo.membersName||""}},[s("i",{staticClass:"iconfont iconicon_weixin"}),e._v("微信名称："+e._s(e.wechatInfo.clientInfo.membersName))]):e._e(),s("img",{staticClass:"history-icon",attrs:{src:i("a5c6")},on:{click:e.showHistoryModal}})])]),s("div",{staticClass:"chat-list"},[s("ChatContent",{attrs:{isUpdateScroll:e.isUpdateScroll},on:{changeUpdateScroll:e.changeUpdateScroll}}),s("div",{staticClass:"chat-history",class:e.isShowHistory?"show":"hide",on:{click:function(e){return e.stopPropagation()}}},[s("p",{staticClass:"title"},[e._v("聊天记录")]),s("div",{staticClass:"search-box"},[s("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"输入搜索聊天记录"},on:{input:e.searchHistory},model:{value:e.historySearch,callback:function(t){e.historySearch=t},expression:"historySearch"}},[s("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("div",{staticClass:"history-content"},[e._l(e.currSessionHistoryData,(function(t){return s("div",{key:t.msgId,staticClass:"content-item"},[s("div",{staticClass:"content-top"},[t.sender===e.myInfo.imUserId?s("span",{staticClass:"name",staticStyle:{color:"#10BBB8"}},[e._v("自己")]):s("span",{staticClass:"name"},[e._v(e._s(e.handleShowPrivateChatName(t.sender)))]),s("span",{staticClass:"time"},[e._v(e._s(e._f("transformTime")(t.createTime)))])]),s("div",{staticClass:"msg ellipsis"},[e._v(e._s(t.content.ext.data))])])})),0===e.currSessionHistoryData.length?s("div",{staticClass:"no-data"},[e._v("暂无搜索结果")]):e._e()],2)])],1),s("div",{staticClass:"chat-input"},[s("div",{staticClass:"chat-function"},[s("div",{staticClass:"img-icon"},[s("el-upload",{attrs:{action:"#","list-type":"picture-card","show-file-list":!1,"auto-upload":!0,"before-upload":e.handleUploadImage}},[s("i",{staticClass:"el-icon-picture-outline",attrs:{slot:"default"},slot:"default"})])],1),s("div",{staticClass:"img-icon"},[s("el-upload",{attrs:{action:"#","list-type":"picture-card","auto-upload":!0,"before-upload":e.handleUploadFile,"show-file-list":!1}},[s("i",{staticClass:"el-icon-folder",attrs:{slot:"default"},slot:"default"})])],1)]),s("div",{staticClass:"input-box"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.content,expression:"content"}],staticClass:"text-area",attrs:{placeholder:"按 Enter 发送"},domProps:{value:e.content},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addMessageClick(t)},input:function(t){t.target.composing||(e.content=t.target.value)}}})])])]):e._e()]),s("div",{staticClass:"page-right"},[s("div",{staticClass:"tab"},e._l(e.tabs,(function(t){return s("div",{directives:[{name:"show",rawName:"v-show",value:!t.disabled,expression:"!tab.disabled"}],key:t.id,staticClass:"tab__item",class:e.activeTab==t.id?"tab__item--active":"",on:{click:function(i){return e.handleClick(t)}}},[e._v(" "+e._s(t.label)+" ")])})),0),s("div",{staticClass:"tab-content"},[4==e.activeTab?s("GroupInfo",{attrs:{members:e.wechatInfo.members}}):2==e.activeTab?s("ClientInfo",{attrs:{clientInfo:e.wechatInfo.clientInfo}}):3==e.activeTab?s("QuickReply"):e._e()],1)]),e.isShowAddFriend?s("AddFriend",{attrs:{show:e.isShowAddFriend},on:{hideCancel:e.hideAddFriend}}):e._e()],1)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"person-avatar"},[i("img",{attrs:{src:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1587704889140&di=05a13cf8be891abb2acde989971e5550&imgtype=0&src=http%3A%2F%2Fcdn.duitang.com%2Fuploads%2Fitem%2F201409%2F08%2F20140908130732_kVXzh.jpeg"}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"person-handle"},[i("i",{staticClass:"iconfont iconicon_add_friend"}),i("span",[e._v("查看朋友圈")])])}],o=(i("dbb3"),i("fe59"),i("ecb4"),i("6db4"),i("08ba"),i("80a0")),a=(i("fec7"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"session-item",class:[e.item.active?"active":""]},[i("div",{staticClass:"avatar"},[3==e.item.groupType&&e.item.groupIcon?i("img",{attrs:{src:e.item.groupIcon||e.item.userIcon}}):3!=e.item.groupType||e.item.groupIcon?i("span",{staticClass:"avatar-nickname"},[e._v(e._s(e.item.nickName?e.item.nickName.substring(0,1):""))]):i("i",{staticClass:"iconfont iconicon_groupchat"}),e.item.unReadNum?i("span",{staticClass:"unread"},[e._v(e._s(e.item.unReadNum>99?"99+":e.item.unReadNum))]):e._e()]),i("div",{staticClass:"session-info"},[i("div",{staticClass:"nickname ellipsis"},[e._v(e._s(e.item.groupName||""))]),i("div",{staticClass:"content"},[i("p",{staticClass:"ellipsis"},[e._v(e._s(e._f("covertMessage")(e.item.lastContent)))]),i("span",[e._v(" "+e._s(e._f("messageTime")(parseInt(e.item.lastTime)||e.item.createTime)))])])])])}),c=[],l=(i("e18c"),i("1c2e"),{name:"SessionItem",props:{item:{type:Object,default:function(){return{}}}},filters:{covertMessage:function(e){if(e&&e.ext)try{var t="[object Object]"==Object.prototype.toString.call(e.ext)?e.ext:JSON.parse(e.ext),i={1:"文本消息",3:"图片消息",34:"语音消息",37:"好友请求",40:"好友发起",42:"名片消息",43:"小视频消息",47:"表情消息",48:"位置消息",49:"文件/链接消息",50:"语音电话",51:"微信初始化",52:"语言电话通知",53:"语言电话邀请",62:"短视频消息",64:"语音通话消息",9999:"系统通知",570425393:"建群消息",1e4:"红包/系统消息",10002:"撤回消息",436207665:"红包/系统消息","-1879048186":"位置共享消息",452984881:"卡券消息"};return 1==t.type?t.data:"【".concat(i[t.type]||"未知消息类型","】")}catch(s){console.log(s)}return""}},watch:{},data:function(){return{curChatId:""}}}),r=l,d=(i("f90e"),i("4023")),m=Object(d["a"])(r,a,c,!1,null,"43da0cac",null),f=m.exports,u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"messageBox",staticClass:"chat-content"},e._l(e.currSessionData,(function(t,n){return s("div",{key:n,staticClass:"chat-item",attrs:{id:"message"+n}},[s("p",{staticClass:"time"},[s("span",[e._v(e._s(e._f("messageTime")(t.createTime)))])]),s("div",{staticClass:"message-content",class:{self:t.sender==e.myInfo.imUserId}},[s("div",{staticClass:"content-box"},[s("div",{staticClass:"nickname"},[e._v("哈哈哈")]),s("div",{staticClass:"content"},[t.sender==e.myInfo.imUserId?s("span",{staticClass:"msg-status"},[t.sender==e.myInfo.imUserId&&1==t.msgStatus?s("i",{staticClass:"el-icon-loading"}):e._e(),t.sender==e.myInfo.imUserId&&2==t.msgStatus?s("span",{staticClass:"failed",on:{click:function(i){return e.handleRepeatSend(t.localMsgId)}}},[s("img",{attrs:{src:i("98bd")}}),s("i",[e._v("重新发送")])]):e._e()]):e._e(),s("div",{staticClass:"msg"},[t.content&&"text"===t.msgType&&37==t.content.ext.type?s("p",{staticClass:"text",domProps:{innerHTML:e._s(t.content.ext.data)}}):e._e(),t.content&&"text"===t.msgType&&1==t.content.ext.type?s("p",{staticClass:"text",domProps:{innerHTML:e._s(e.covertMessageText(t.content.ext.data)||"消息格式有误")}}):e._e(),t.content&&"text"===t.msgType&&3==t.content.ext.type&&t.content.ext.data&&(t.content.ext.data.thumbUrl||t.content.ext.data.fileUrl)?s("img",{staticStyle:{height:"100px"},attrs:{src:t.content.ext.data.thumbUrl||t.content.ext.data.fileUrl}}):e._e(),t.content&&"text"===t.msgType&&47==t.content.ext.type&&t.content.ext.data?s("img",{staticStyle:{height:"100px"},attrs:{src:t.content.ext.data}}):e._e(),t.content&&"video"===t.msgType?s("video",{staticStyle:{width:"200px"},attrs:{controls:"controls",src:t.content.fileUrl}},[e._v("您的浏览器不支持 video 标签。")]):e._e(),t.content&&"text"===t.msgType&&"voice"===t.msgType?s("audio",{staticStyle:{width:"300px",height:"40px"},attrs:{controls:"controls",src:t.content.fileUrl}},[e._v("您的浏览器不支持 audio 标签。")]):e._e(),t.content&&"text"===t.msgType&&49==t.content.ext.type&&t.content.ext.data?s("div",{staticClass:"doc",on:{dblclick:function(i){return e.downloadFile(t.content.ext.data)}}},[s("img",{attrs:{src:i("20ac")}}),s("div",{staticClass:"doc-content"},[s("div",{staticClass:"doc-name ellipsis"},[e._v(e._s(t.content.ext.data.fileName||""))]),s("div",{staticClass:"doc-size"},[e._v(e._s(e._f("calculatedSize")(t.content.ext.data.fileSize)))])])]):e._e()])])])])])})),0)},p=[],g=(i("513c"),i("e35a"),i("f4e3"),i("5e9f"),i("ae8c")),h=(i("b4fb"),i("fe8a"),"./emojis/"),v=[],_={emoji:{"[龇牙]":{file:"emoji_001.png"},"[呲牙]":{file:"emoji_001.png"},"[调皮]":{file:"emoji_002.png"},"[流汗]":{file:"emoji_003.png"},"[偷笑]":{file:"emoji_004.png"},"[再见]":{file:"emoji_005.png"},"[敲打]":{file:"emoji_006.png"},"[擦汗]":{file:"emoji_007.png"},"[猪头]":{file:"emoji_008.png"},"[玫瑰]":{file:"emoji_009.png"},"[流泪]":{file:"emoji_010.png"},"[大哭]":{file:"emoji_011.png"},"[嘘]":{file:"emoji_012.png"},"[酷]":{file:"emoji_013.png"},"[抓狂]":{file:"emoji_014.png"},"[委屈]":{file:"emoji_015.png"},"[便便]":{file:"emoji_016.png"},"[炸弹]":{file:"emoji_017.png"},"[菜刀]":{file:"emoji_018.png"},"[可爱]":{file:"emoji_019.png"},"[色]":{file:"emoji_020.png"},"[害羞]":{file:"emoji_021.png"},"[得意]":{file:"emoji_022.png"},"[吐]":{file:"emoji_023.png"},"[微笑]":{file:"emoji_024.png"},"[怒]":{file:"emoji_025.png"},"[尴尬]":{file:"emoji_026.png"},"[惊恐]":{file:"emoji_027.png"},"[冷汗]":{file:"emoji_028.png"},"[爱心]":{file:"emoji_029.png"},"[示爱]":{file:"emoji_030.png"},"[白眼]":{file:"emoji_031.png"},"[傲慢]":{file:"emoji_032.png"},"[难过]":{file:"emoji_033.png"},"[惊讶]":{file:"emoji_034.png"},"[疑问]":{file:"emoji_035.png"},"[困]":{file:"emoji_036.png"},"[么么哒]":{file:"emoji_037.png"},"[憨笑]":{file:"emoji_038.png"},"[爱情]":{file:"emoji_039.png"},"[衰]":{file:"emoji_040.png"},"[撇嘴]":{file:"emoji_041.png"},"[阴险]":{file:"emoji_042.png"},"[奋斗]":{file:"emoji_043.png"},"[发呆]":{file:"emoji_044.png"},"[右哼哼]":{file:"emoji_045.png"},"[抱抱]":{file:"emoji_046.png"},"[坏笑]":{file:"emoji_047.png"},"[飞吻]":{file:"emoji_048.png"},"[鄙视]":{file:"emoji_049.png"},"[晕]":{file:"emoji_050.png"},"[大兵]":{file:"emoji_051.png"},"[可怜]":{file:"emoji_052.png"},"[强]":{file:"emoji_053.png"},"[弱]":{file:"emoji_054.png"},"[握手]":{file:"emoji_055.png"},"[胜利]":{file:"emoji_056.png"},"[抱拳]":{file:"emoji_057.png"},"[凋谢]":{file:"emoji_058.png"},"[米饭]":{file:"emoji_059.png"},"[蛋糕]":{file:"emoji_060.png"},"[西瓜]":{file:"emoji_061.png"},"[啤酒]":{file:"emoji_062.png"},"[瓢虫]":{file:"emoji_063.png"},"[勾引]":{file:"emoji_064.png"},"[OK]":{file:"emoji_065.png"},"[爱你]":{file:"emoji_066.png"},"[咖啡]":{file:"emoji_067.png"},"[月亮]":{file:"emoji_068.png"},"[刀]":{file:"emoji_069.png"},"[发抖]":{file:"emoji_070.png"},"[差劲]":{file:"emoji_071.png"},"[拳头]":{file:"emoji_072.png"},"[心碎了]":{file:"emoji_073.png"},"[太阳]":{file:"emoji_074.png"},"[礼物]":{file:"emoji_075.png"},"[皮球]":{file:"emoji_076.png"},"[骷髅]":{file:"emoji_077.png"},"[挥手]":{file:"emoji_078.png"},"[闪电]":{file:"emoji_079.png"},"[饥饿]":{file:"emoji_080.png"},"[睡觉]":{file:"emoji_145.png"},"[咒骂]":{file:"emoji_082.png"},"[折磨]":{file:"emoji_083.png"},"[抠鼻]":{file:"emoji_084.png"},"[鼓掌]":{file:"emoji_085.png"},"[糗大了]":{file:"emoji_086.png"},"[左哼哼]":{file:"emoji_087.png"},"[打哈欠]":{file:"emoji_088.png"},"[快哭了]":{file:"emoji_089.png"},"[吓]":{file:"emoji_090.png"},"[篮球]":{file:"emoji_091.png"},"[乒乓]":{file:"emoji_092.png"},"[NO]":{file:"emoji_093.png"},"[跳跳]":{file:"emoji_094.png"},"[怄火]":{file:"emoji_095.png"},"[转圈]":{file:"emoji_096.png"},"[磕头]":{file:"emoji_097.png"},"[回头]":{file:"emoji_098.png"},"[跳绳]":{file:"emoji_099.png"},"[激动]":{file:"emoji_100.png"},"[街舞]":{file:"emoji_101.png"},"[献吻]":{file:"emoji_102.png"},"[左太极]":{file:"emoji_103.png"},"[右太极]":{file:"emoji_104.png"},"[闭嘴]":{file:"emoji_105.png"},"[猫咪]":{file:"emoji_106.png"},"[红双喜]":{file:"emoji_107.png"},"[鞭炮]":{file:"emoji_108.png"},"[红灯笼]":{file:"emoji_109.png"},"[麻将]":{file:"emoji_110.png"},"[麦克风]":{file:"emoji_111.png"},"[礼品袋]":{file:"emoji_112.png"},"[信封]":{file:"emoji_113.png"},"[象棋]":{file:"emoji_114.png"},"[彩带]":{file:"emoji_115.png"},"[蜡烛]":{file:"emoji_116.png"},"[爆筋]":{file:"emoji_117.png"},"[棒棒糖]":{file:"emoji_118.png"},"[奶瓶]":{file:"emoji_119.png"},"[面条]":{file:"emoji_120.png"},"[香蕉]":{file:"emoji_121.png"},"[飞机]":{file:"emoji_122.png"},"[左车头]":{file:"emoji_124.png"},"[车厢]":{file:"emoji_125.png"},"[右车头]":{file:"emoji_126.png"},"[多云]":{file:"emoji_127.png"},"[下雨]":{file:"emoji_128.png"},"[钞票]":{file:"emoji_129.png"},"[熊猫]":{file:"emoji_130.png"},"[灯泡]":{file:"emoji_131.png"},"[风车]":{file:"emoji_132.png"},"[闹钟]":{file:"emoji_133.png"},"[彩球]":{file:"emoji_135.png"},"[钻戒]":{file:"emoji_136.png"},"[沙发]":{file:"emoji_137.png"},"[纸巾]":{file:"emoji_138.png"},"[手枪]":{file:"emoji_140.png"},"[青蛙]":{file:"emoji_141.png"},"[汽车]":{file:"emoji_142.png"},"[雨伞]":{file:"emoji_143.png"},"[药]":{file:"emoji_144.png"}}};for(var C in _){var b=_[C];for(var y in b){var I=b[y];I.img="".concat(h).concat(C,"/").concat(I.file)}}for(var j in _){var S=_[j];for(var x in S){var w=S[x];w.img="".concat(h).concat(j,"/").concat(w.file)}v.push({album:j,img:S[Object.keys(S)[0]]["img"]})}var A={emojiList:_,albumArr:v},k=i("ed08"),U={name:"ChatContent",props:{userInfos:{type:Object,default:function(){return{}}},isHistory:{type:Boolean,default:!1},curAudio:{type:String,default:""},isUpdateScroll:{type:Number,default:1}},watch:{isScrollBottom:{deep:!0,handler:function(e,t){var i=this;if(e){var s=null;s=setTimeout((function(){var e=i.$refs["messageBox"];e.scrollTop=e.scrollHeight,clearTimeout(s)}),50)}}},isUpdateScroll:function(e,t){if(e){this.currentChatScrollVal=0;try{this.$refs["messageBox"].removeEventListener("scroll",this.currentChatLoadMore,!0),this.$refs["messageBox"].addEventListener("scroll",this.currentChatLoadMore,!0)}catch(y){}this.getHistoryMsgs(),this.$emit("changeUpdateScroll",!1)}}},data:function(){return{msg:"",curVideo:"",videoCtx:{},isFullscreen:!1,playIndex:null,currentChatScrollVal:0,lock:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(g["b"])(["isScrollBottom"])),{},{currSessionData:function(){return this.$store.state.currSessionData},myInfo:function(){return this.$store.state.myInfo}}),methods:{covertMessageText:function(e){var t=k["a"].escape(e);if(/\[([^\[\]]+)\]/.test(t)){var i=t.match(/\[([^\[\]]+)\]/g);i.forEach((function(e){var i=A.emojiList.emoji;i[e]&&(t=t.replace(e,'<img class="emoji" src="'.concat(i[e].img,'">')))}))}return t},downloadFile:function(e){var t=e.fileId,i=e.fileUrl;if(t){var s={fileId:t};this.$store.dispatch("downloadFile",s)}else window.location.href=i},handleRepeatSend:function(e){if(!e)return!1;var t=this,i=null,s=t.currSessionData.filter((function(t){return t.localMsgId===e&&(i=t),t.localMsgId!==e}));i&&(this.$store.state.currSessionData=s,t.$store.dispatch("sendMsg",{recver:i.recver,dstSyscode:i.dstSyscode,content:i.content,receiveType:i.receiveType,msgClass:i.msgClass,msgType:i.msgType}))},scrollVal:function(){var e=this;e.$nextTick((function(){var t=e.$refs["messageBox"],i=t.scrollHeight-t.offsetHeight;e.currentChatScrollVal>0?(i-=e.currentChatScrollVal,e.currentChatScrollVal=t.scrollHeight-t.offsetHeight):e.currentChatScrollVal=i,t.scrollTop=i}))},getHistoryMsgs:function(){var e=this;e.lock=!0,e.$store.dispatch("getHistoryMsgs",{pageNumber:1,pageSize:30}).then((function(t){e.scrollVal(),setTimeout((function(){e.lock=!1}),200)})).catch((function(e){console.log(e)}))},currentChatLoadMore:function(e){if(this.lock)return!1;if(!e||!e.srcElement||!e.srcElement.scrollTop||e.srcElement.scrollTop>100)return!1;if(this.$store.state.noMoreCurrSessionMsgs)return!1;this.lock=!0;var t=this,i="",s=t.$loading({text:"加载中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)"});try{i=t.currSessionData[t.currSessionData.length-1].createDatetime||""}catch(e){}this.$store.state.currChatPageNumber+=1,t.$store.dispatch("getHistoryMsgs",{pageNumber:this.$store.state.currChatPageNumber,pageSize:this.$store.state.currChatPageSize,localPoint:i}).then((function(e){t.scrollVal(),setTimeout((function(){t.lock=!1,s.close()}),200)})).catch((function(e){console.log(e)}))}}},T=U,N=(i("6710"),Object(d["a"])(T,u,p,!1,null,"70bf7975",null)),E=N.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dgg-modal",{attrs:{show:e.show,title:"添加好友",custom:!1},on:{cancel:e.hideCancel}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"add-friend-tab"},e._l(e.addTypes,(function(t,s){return i("div",{key:s,staticClass:"add-friend-tab__item",class:[e.curType===t.id?"add-friend-tab__item--active":""]},[e._v(" "+e._s(t.name)+" ")])})),0),i("div",{staticClass:"add-friend-content"},[i("div",{staticClass:"content-box"},[i("div",{staticClass:"search-box"},[i("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入内容"},on:{input:e.findCrmBussiness},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),i("div",{staticClass:"content"},[e._l(e.crmUsers,(function(t){return i("div",{key:t.id,staticClass:"content__item"},[i("div",{staticClass:"content-left"},[i("el-radio",{attrs:{label:t.customerId},model:{value:e.customerId,callback:function(t){e.customerId=t},expression:"customerId"}},[i("span",{staticClass:"avatar"},[e._v(e._s(t.customerName?t.customerName.substring(0,1):""))])])],1),i("div",{staticClass:"content-center"},[i("div",{staticClass:"name"},[e._v(e._s(t.customerName)),i("span",[e._v(e._s("（主联系人："+(t.phoneList&&t.phoneList.length>0?t.mainContact:"无主联系人数据")+"）"))])]),i("div",{staticClass:"no"},[e._v(e._s(t.typeCode)+" "+e._s(t.no))]),i("div",{staticClass:"address"},[e._v("区域："+e._s(t.province+" "+t.city+" "+t.area))])]),i("div",{staticClass:"content-right"},[i("el-select",{attrs:{placeholder:"选择号码",size:"mini"},model:{value:t.choosePhone,callback:function(i){e.$set(t,"choosePhone",i)},expression:"item.choosePhone"}},e._l(t.phoneList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name+" "+e.no,value:e.id}})})),1)],1)])})),0==e.crmUsers.length?i("div",{staticClass:"no-content"},[e._v(" 暂无数据 ")]):e._e()],2)]),i("div",{staticClass:"content-bottom"},[i("div",{staticClass:"remark"},[i("el-input",{attrs:{rows:"4",type:"textarea",placeholder:"请输入添加好友信息（限50字）",maxlength:"50","show-word-limit":""},model:{value:e.newData.information,callback:function(t){e.$set(e.newData,"information",t)},expression:"newData.information"}})],1),i("div",{staticClass:"hanle-btn"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleAddFriend}},[e._v("发送好友申请")])],1)])])])])},B=[],F=(i("053b"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.show,width:e.width+"px","before-close":e.handleClickCancel},on:{"update:visible":function(t){e.show=t}}},[e.title?i("div",{staticClass:"dgg-title",style:{backgroundColor:e.titleBg?e.titleBg:"rgba(246, 246, 246, 1)"},attrs:{slot:"title"},slot:"title"},[i("span",[e._v(e._s(e.title))])]):e._e(),i("div",{staticClass:"dgg-content",style:{color:e.color,fontSize:e.size}},[e._t("default")],2)])}),P=[],H={name:"DggModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:Number,default:600},titleBg:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},button:{type:Array,default:function(){return[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red",plain:!1}]}},maskClosable:{type:Boolean,default:!0},custom:{type:Boolean,default:!1}},data:function(){return{}},methods:{handleClick:function(e){if(this.show){var t=e.currentTarget.dataset;this.$emit("click",{index:Number(t.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")}}},M=H,V=(i("4e1e"),Object(d["a"])(M,F,P,!1,null,"3b529354",null)),D=V.exports,L=i("ebcb"),R=i("365c"),$={name:"AddFriend",components:{DggModal:D},mixins:[L["a"]],props:{show:{type:Boolean,default:!1}},data:function(){return{addTypes:[{id:1,name:"CRM商机"}],keyWord:"",curType:1,crmUsers:[],customerId:"",newData:{information:""}}},mounted:function(){this.findCrmBussiness()},methods:{handleAddFriend:function(){var e=this;if(this.customerId){for(var t=!1,i={},s=0;s<this.crmUsers.length;s++)if(!this.crmUsers[s].choosePhone&&this.customerId==this.crmUsers[s].customerId)return void this.$message.error("请选择手机号！");for(var n=0;n<this.crmUsers.length;n++)if(this.crmUsers[n].choosePhone&&this.customerId==this.crmUsers[n].customerId){for(var o=0;o<this.crmUsers[n].phoneList.length;o++)this.crmUsers[n].choosePhone==this.crmUsers[n].phoneList[o].id&&(i.nikeName=this.crmUsers[n].phoneList[o].name,i.customerPhone=this.crmUsers[n].phoneList[o].contactNo,t=!0);if(t)break}var a=localStorage.getItem("TOPUSERINFO")?JSON.parse(localStorage.getItem("TOPUSERINFO")):{};Object(R["a"])({merchantId:"999",businessWorkId:a.loginName,groupName:i.nikeName,businessId:a.userCenterId,customerPhone:i.customerPhone,information:this.newData.information,nikeName:i.nikeName,crmCustomerId:this.customerId,label:"",describe:""}).then((function(t){t&&200==t.code&&e.hideCancel()})).catch((function(e){}))}else this.$message.error("请选择商机")},hideCancel:function(){this.$emit("hideCancel",!1)}}},Y=$,z=(i("06f1"),Object(d["a"])(Y,O,B,!1,null,"75575347",null)),G=z.exports,Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"group-info"},[i("div",{staticClass:"group-name"},[e._m(0),i("div",{staticClass:"name"},[e._v(e._s(e.currGroupChatInfo.groupName))])]),i("div",{staticClass:"group-users"},[i("p",{staticClass:"group-title"},[i("span",[e._v("群成员")]),i("i",{staticClass:"el-icon-user-solid",on:{click:e.addGroupUser}})]),i("div",{staticClass:"users"},e._l(e.members,(function(t){return i("div",{key:t.id,staticClass:"users__item"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:t.membersHeaderThumbnail}})]),i("div",{staticClass:"user-info"},[i("p",{staticClass:"nick-name ellipsis"},[e._v(e._s(t.membersName))]),i("p",{staticClass:"address ellipsis"},[e._v("地址："+e._s(t.address||"暂无"))])])])})),0)]),i("dgg-modal",{attrs:{show:e.show,title:"添加客户",custom:!1,width:500},on:{cancel:e.hideCancel}},[i("div",{staticClass:"add-group-modal"},[i("div",{staticClass:"search-box"},[i("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"请输入内容"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),i("div",{staticClass:"content"},e._l(e.groupUsers,(function(t){return i("div",{key:t.id,staticClass:"content__item"},[i("el-checkbox",{model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"item.checked"}},[i("div",{staticClass:"checkbox-content"},[i("div",{staticClass:"content-left"},[i("span",{staticClass:"avatar"})]),i("div",{staticClass:"content-center"},[i("div",{staticClass:"name"},[e._v(e._s(t.name)),i("span",[e._v(e._s("（"+t.phone+"）"))])])])])])],1)})),0)]),i("div",{staticClass:"hanle-btn"},[e.chooseAount.length>0?i("span",{staticClass:"choosed"},[e._v("已选择"),i("i",[e._v(e._s(e.chooseAount.length))]),e._v("人")]):e._e(),i("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("确定")])],1)])],1)},q=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("p",{staticClass:"group-title"},[i("span",[e._v("群名称")])])}],K={name:"GroupInfo",components:{DggModal:D},props:{members:{type:Array,default:function(){return[]}}},data:function(){return{search:"",show:!1,groupUsers:[]}},computed:Object(o["a"])(Object(o["a"])({},Object(g["b"])(["currGroupChatInfo"])),{},{myInfo:function(){return this.$store.state.myInfo},sessionList:function(){return this.$store.state.sessionList},currSessionId:function(){return this.$store.state.currSessionId},chooseAount:function(){return this.groupUsers.filter((function(e){return e.checked}))||0}}),mounted:function(){this.getCustomerListById({businessId:myInfo.imUserId}).then((function(e){}))},methods:{handleClick:function(e){if(this.show){var t=e.currentTarget.dataset;this.$emit("click",{index:Number(t.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")},addGroupUser:function(){this.show=!0},hideCancel:function(){this.show=!1}}},J=K,W=(i("7251"),Object(d["a"])(J,Q,q,!1,null,"441065de",null)),X=W.exports,Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"client-info"},[i("div",{staticClass:"client-name"},[i("span",{class:e.clientInfo.membersHeaderThumbnail||e.clientInfo.membersHeaderOriginal?"avatar":"iconfont iconicon_groupchat"},[e.clientInfo.membersHeaderThumbnail||e.clientInfo.membersHeaderOriginal?i("img",{attrs:{src:e.clientInfo.membersHeaderThumbnail||e.clientInfo.membersHeaderOriginal}}):e._e()]),i("div",{staticClass:"name"},[e._v(e._s(e.clientInfo.membersName||"暂未获取到昵称"))])]),i("div",{staticClass:"client-content"},[i("div",{staticClass:"client-content__item"},[i("span",{staticClass:"label"},[e._v("性别：")]),i("span",{staticClass:"content"},[e._v(e._s(1==e.clientInfo.membersSex?"男":"0"==e.clientInfo.membersSex?"女":"暂无数据"))])]),i("div",{staticClass:"client-content__item"},[i("span",{staticClass:"label"},[e._v("手机号：")]),i("span",{staticClass:"content"},[e._v(e._s(e.clientInfo.phone.replace(/(\d{3})\d*(\d{2})/,"$1******$2")))])]),i("div",{staticClass:"client-content__item"},[i("span",{staticClass:"label"},[e._v("客户状态：")]),i("span",{staticClass:"content"},[e._v(e._s(1==e.clientInfo.state?"添加成功":"未添加"))])]),i("div",{staticClass:"client-content__item"},[i("span",{staticClass:"label"},[e._v("添加时间：")]),i("span",{staticClass:"content"},[e._v(e._s(e._f("transformTime")(e.clientInfo.createTime)))])])])])},ee=[],te={name:"ClientInfo",props:{clientInfo:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},ie=te,se=(i("cf00"),Object(d["a"])(ie,Z,ee,!1,null,"f7b5fe08",null)),ne=se.exports,oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"quick-reply"},[i("div",{staticClass:"quick-reply-list"},e._l(e.quickReplyData,(function(t){return i("div",{key:t.id,staticClass:"quick-reply-list__item"},[i("div",{staticClass:"content"},[e._v(e._s(t.content))]),i("el-dropdown",{attrs:{size:"mini"},on:{command:e.handleCommand}},[i("span",{staticClass:"el-dropdown-link"},[e._v("...")]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"edit"}},[i("i",{staticClass:"el-icon-edit-outline"}),e._v("编辑")]),i("el-dropdown-item",{attrs:{command:"delete",divided:""}},[i("i",{staticClass:"el-icon-delete"}),e._v("删除")])],1)],1)],1)})),0),i("div",{staticClass:"quick-reply-add",on:{click:function(t){return e.handleCommand("add")}}},[i("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 添加 ")]),i("dgg-modal",{attrs:{show:e.show,title:e.dialogStatus[e.type],titleBg:"#fff",custom:!1,width:500},on:{cancel:e.hideCancel}},[i("div",{staticClass:"modal-content"},[i("el-input",{attrs:{type:"textarea",maxlength:"30","show-word-limit":"",autosize:{minRows:4,maxRows:5}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),i("div",{staticClass:"hanle-btn"},[i("el-button",{attrs:{type:"default",size:"mini"},on:{click:e.hideCancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确定")])],1)])],1)},ae=[],ce={name:"QuickReply",components:{DggModal:D},props:{},data:function(){return{dialogStatus:{edit:"编辑快捷回复",add:"添加快捷回复"},type:"add",quickReplyData:[{content:"你好，你在哪里？",id:1},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:2},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:3},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:4},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:5},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:6},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:7},{content:"你好多了几分上岛咖啡就爱上了地方辣就是的分类就爱上了附件阿拉斯加法拉就是砥砺奋进啊数量加弗拉设计费拉开就萨拉发简历搜集到佛登机口但甲方。",id:8}],content:"",show:!1}},methods:{confirm:function(){},handleCommand:function(e){"edit"!==e&&"add"!==e||(this.show=!0,this.type=e)},hideCancel:function(){this.show=!1}}},le=ce,re=(i("0fc2"),Object(d["a"])(le,oe,ae,!1,null,"e3dcc9b4",null)),de=re.exports,me=(i("6ae3"),{data:function(){return{}},methods:{handleUploadImage:function(e){var t=this,i=this,s=k["a"].checkUploadImage(e);if(!s)return!1;var n=i.$loading({lock:!0,text:"上传图片中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),o={file:e};i.$store.state.nim.uploadFile({data:o,success:function(s){if(console.log("success:"),console.log(s),n.close(),0===s.code){i.$message({message:"上传图片成功",type:"success"}),console.log(s.data);var o=s.data.filepath,a=new Image;a.src=s.data.filepath,a.onload=function(){var n=s.data.fileid;i.$store.commit("SET_SCROLL_BOTTOM",!1),i.$store.dispatch("sendMsg",{recver:t.currSessionId,dstSyscode:"invoice_service_001",content:{ext:{type:3,employeeNo:"102395",data:{fileId:n,fileName:e.name,fileUrl:o,width:a.width,height:a.height,fileSize:e.size,fileType:e.type,thumbUrl:"".concat(o,"?x-oss-process=image/resize,w_100,h_100")}}},receiveType:2,msgClass:5,msgType:"text"})}}else i.$message({message:s.msg,type:"error"})},fail:function(e){console.log("fail: "),console.log(e)},complete:function(e){console.log("complete:"),console.log(e)},onProgressUpdate:function(e){if(console.log("progressEvt"),console.log(e),e.lengthComputable){var t=Math.round(e.loaded/e.total*100)+"%";console.log("---当前上传进度: "+t)}},onUploadComplete:function(e){console.log("上传完成..."),console.log("onUploadComplete:"),console.log(e),n.close()},onUploadError:function(e){console.log("上传出错..."),console.log("onUploadError:"),console.log(e),n.close()}})},handleUploadFile:function(e){var t=this,i=this,s=k["a"].checkUploadFile(e);if(!s)return!1;var n={file:e},o=i.$loading({lock:!0,text:"上传文件中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});i.$store.state.nim.uploadFile({data:n,success:function(s){if(console.log("success:"),console.log(s),0===s.code){i.$message({message:"上传文件成功",type:"success"});var n=s.data.filepath,o=e.name,a=o.substring(o.lastIndexOf(".")+1),c=["avi","mov","rmvb","rm","flv","mp4","3gp"],l=-1!==c.indexOf(a.toLowerCase())?"43":"49",r=s.data.fileid,d={type:l,employeeNo:"102395",data:{fileId:r,fileName:e.name,fileUrl:n,fileSize:e.size,fileType:e.type,thumbUrl:n+("video"===l?"?x-oss-process=video/snapshot,t_10000,m_fast,ar_auto":"")}};i.$store.dispatch("sendMsg",{recver:t.currSessionId,dstSyscode:"invoice_service_001",content:{ext:d},receiveType:2,msgClass:5,msgType:"text"})}else i.$message({message:s.msg,type:"error"})},fail:function(e){console.log("fail: "),console.log(e)},complete:function(e){console.log("complete:"),console.log(e)},onProgressUpdate:function(e){if(console.log("progressEvt"),console.log(e),e.lengthComputable){var t=Math.round(e.loaded/e.total*100)+"%";console.log("---当前上传进度: "+t)}},onUploadComplete:function(e){console.log("上传完成..."),console.log("onUploadComplete:"),console.log(e),o.close()},onUploadError:function(e){console.log("上传完成..."),console.log("onUploadError:"),console.log(e),o.close()}})}}}),fe={methods:{scrollVal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;setTimeout((function(){try{e?t.$nextTick((function(){var e=t.$refs["historyScroll"],i=e.scrollHeight-e.offsetHeight;t.historyDataScrollVal>0?(i-=t.historyDataScrollVal,t.historyDataScrollVal=e.scrollHeight-e.offsetHeight):t.historyDataScrollVal=i,e.scrollTop=i})):t.$nextTick((function(){var e=t.$refs["messageBox"],i=e.scrollHeight-e.offsetHeight;console.log(e.scrollHeight),console.log(e.offsetHeight),console.log(t.currentChatScrollVal),t.currentChatScrollVal>0?(i-=t.currentChatScrollVal,t.currentChatScrollVal=e.scrollHeight-e.offsetHeight):t.currentChatScrollVal=i,console.log(i),e.scrollTop=i}))}catch(y){}}),200)}}},ue=i("ca00"),pe={name:"Index",components:{SessionItem:f,ChatContent:E,AddFriend:G,GroupInfo:X,ClientInfo:ne,QuickReply:de},mixins:[me,fe],data:function(){return{options:[],tabs:[],activeTab:0,value:"1",searchUser:"",content:"",isShowAddFriend:!1,curChatType:"group",historyDataScrollVal:0,currentChatScrollVal:0,currentChatHistoryData:[],lock:!1,isUpdateScroll:0,isShowHistory:!1,searchMessage:"",historySearch:"",topUserInfo:{},topSessionId:"",wechatInfo:{type:"",members:[],clientInfo:{}}}},computed:Object(o["a"])(Object(o["a"])({},Object(g["b"])(["currGroupChatInfo","currHistoryPageNumber","currHistoryPageSize","currSessionHistoryData"])),{},{myInfo:function(){return this.$store.state.myInfo},sessionList:function(){return this.$store.state.sessionList},currSessionId:function(){return this.$store.state.currSessionId},handleShowPrivateChatName:function(){return function(e){var t=this.sessionList,i=t.filter((function(t){return t.groupId===e})),s=i[0]||{};return s.groupName||"没有名字"}}}),watch:{searchUser:function(e,t){this.sessionList.forEach((function(t){t.show=!0;var i=t.groupName||t.nickName||t.userName||"";-1!=i.indexOf(e)&&(t.show=!1)}))}},beforeCreate:function(){this.topUserInfo=window.top&&"function"===typeof window.top.getUserInfo&&window.top.getUserInfo()||{},this.topSessionId=window.top&&"function"===typeof window.top.getSessionId&&window.top.getSessionId()||"",localStorage.setItem("TOPUSERINFO",JSON.stringify(this.topUserInfo)),localStorage.setItem("TOPSESSIONID",this.topSessionId),this.topUserInfo&&this.topUserInfo.userCenterId&&this.topSessionId&&this.$store.dispatch("connect",{token:this.topSessionId,userId:this.topUserInfo.userCenterId})},mounted:function(){var e=this;if(this.isUpdateScroll=0,window.addEventListener("click",(function(){e.isShowHistory=!1})),this.currSessionId){var t=localStorage.getItem("SET_CURGROUP_INFO")?JSON.parse(localStorage.getItem("SET_CURGROUP_INFO")):{};this.changeCurrSessionItem(t)}},beforeDestroy:function(){this.currSessionId&&this.$store.dispatch("setCurrSession"),this.$store.state.nim&&(this.$store.state.nim.disConnect(),this.$store.state.nim=null)},methods:{searchHistory:function(e){var t=this;if(this.$store.state.currHistoryPageNumber=1,this.$store.state.currHistoryPageSize=1e3,this.$store.state.historyDataScrollVal=0,this.$store.state.isSearchHistory=!0,this.$store.state.currSessionHistoryData=[],this.$store.state.noMoreHistoryMsgs=!1,this.historySearch){var i=function(){if(t.lock)return!1;t.lock=!0,t.$store.dispatch("getHistoryMsgs",{pageNumber:t.currHistoryPageNumber,pageSize:t.currHistoryPageSize,history:!0,contentKey:t.historySearch}).then((function(e){setTimeout((function(){t.lock=!1}),200)})).catch((function(e){console.log(e)}))};Object(ue["a"])(i,500)}},showHistoryModal:function(e){e.stopPropagation(),this.isShowHistory=!0,this.historySearch=""},handleCommand:function(){},changeUpdateScroll:function(){this.isUpdateScroll=0},changeCurrSessionItem:function(e){var t=this,i=e.groupId,s=void 0===i?"":i,n=e.groupName,o=void 0===n?"":n;this.$store.state.currChatPageNumber=1,this.$store.dispatch("setCurrSession",s),localStorage.setItem("currSessionId",s);var a={groupId:s,groupName:o};localStorage.setItem("SET_CURGROUP_INFO",JSON.stringify(a)),this.$store.commit("SET_CURGROUP_INFO",a),Object(R["d"])({id:this.currSessionId}).then((function(e){if(200==e.code){var i=e.data;i&&(1==i.type?(t.tabs=[{id:4,label:"群资料",disabled:!1},{id:3,label:"快捷回复",disabled:!1}],t.activeTab=4,t.wechatInfo={type:i.type,members:i.members,clientInfo:{}}):(t.tabs=[{label:"客户资料",id:2,disabled:!1},{label:"客户跟进",id:1},{label:"快捷回复",id:3}],t.activeTab=2,t.wechatInfo={type:i.type,members:[],clientInfo:i.members[0]}))}}));var c=setTimeout((function(){t.isUpdateScroll+=1,clearTimeout(c)}),20)},handleClick:function(e){this.activeTab=e.id},addFriend:function(){this.isShowAddFriend=!0},hideAddFriend:function(e){this.isShowAddFriend=e},addMessageClick:function(){var e=this;if(e.content.trim()){var t={type:1,data:e.content.trim(),employeeNo:"102395"};e.$store.commit("SET_SCROLL_BOTTOM",!1),e.$store.dispatch("sendMsg",{recver:this.currSessionId,dstSyscode:"invoice_service_001",content:{ext:t},receiveType:2,msgClass:5,msgType:"text"}),e.content=""}else e.$message({message:"不能发送空白消息",type:"warning",customClass:"dgg-tip-msg"})}}},ge=pe,he=Object(d["a"])(ge,s,n,!1,null,null,null);t["default"]=he.exports},4194:function(e,t,i){"use strict";var s=i("1c8b"),n=i("5dfd").find,o=i("258f"),a=i("ff9c"),c="find",l=!0,r=a(c);c in[]&&Array(1)[c]((function(){l=!1})),s({target:"Array",proto:!0,forced:l||!r},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o(c)},4572:function(e,t,i){},"4e1e":function(e,t,i){"use strict";var s=i("85ae"),n=i.n(s);n.a},"513c":function(e,t,i){"use strict";var s=i("1e2c"),n=i("d890"),o=i("e8d6"),a=i("1944"),c=i("faa8"),l=i("2118"),r=i("7063"),d=i("9f67"),m=i("efe2"),f=i("6d60"),u=i("b338").f,p=i("aa6b").f,g=i("d910").f,h=i("c10f").trim,v="Number",_=n[v],C=_.prototype,b=l(f(C))==v,y=function(e){var t,i,s,n,o,a,c,l,r=d(e,!1);if("string"==typeof r&&r.length>2)if(r=h(r),t=r.charCodeAt(0),43===t||45===t){if(i=r.charCodeAt(2),88===i||120===i)return NaN}else if(48===t){switch(r.charCodeAt(1)){case 66:case 98:s=2,n=49;break;case 79:case 111:s=8,n=55;break;default:return+r}for(o=r.slice(2),a=o.length,c=0;c<a;c++)if(l=o.charCodeAt(c),l<48||l>n)return NaN;return parseInt(o,s)}return+r};if(o(v,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var I,j=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof j&&(b?m((function(){C.valueOf.call(i)})):l(i)!=v)?r(new _(y(t)),i,j):y(t)},S=s?u(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;S.length>x;x++)c(_,I=S[x])&&!c(j,I)&&g(j,I,p(_,I));j.prototype=C,C.constructor=j,a(n,v,j)}},6710:function(e,t,i){"use strict";var s=i("4572"),n=i.n(s);n.a},7063:function(e,t,i){var s=i("a719"),n=i("50fb");e.exports=function(e,t,i){var o,a;return n&&"function"==typeof(o=t.constructor)&&o!==i&&s(a=o.prototype)&&a!==i.prototype&&n(e,a),e}},7251:function(e,t,i){"use strict";var s=i("c3d7"),n=i.n(s);n.a},"85ae":function(e,t,i){},"8d72":function(e,t,i){},"8ede":function(e,t,i){},"98bd":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAD3klEQVRIS61WXWgcVRT+ztywaWfSYsEfBAVrg7v3brZBbYitleZBhFJrBcGCFFJU+uaD+AMVoSD414c+KqLBCvqgoogVSh8EMbUWwkJtmDvdkrTFFlpBUJOdTZp05sjdzLSz2flJtffxnvOd79xzzx+h4DBA81I+xpa1g5kfBdAPYF0E+wvAFBGdoDD8YZXnjRPAeSYpS8iA1VJqL4D9EUmRb0Y+BeBdW+vDBIRpgFTCuXJ5fSjElwCGVsKSojNhBcHu1Y3G+eWyLsLZgYERKwy/BnD7fySLYX9azM+s9ryfk3Y6CJsDA09QGB4BUPqfZDF8gYme6nPdY/HFdcKZcrncI8QEA2tuEVlsphkEwaa1jUbDXLQJGRAtpX4t+LPLYP6Ahfje6e31qF5f9KW8myxrhJlfArA5x9EJW+vNBARtQl+p5wGM5QA+snt6XqHTp/0snZaUu5noEwB9qTrMLzqeN0amzlpKnc1MfaK3Hdd9s+2YlDtAZF7zcGR4GszfLvT2Hlp36tTfvpQPgWgcgJ1COmVr/QDNVSrbQsv6KcPzY7bW22FqUsoxEI1m6F0Mge1rtHab1eooMR9O07PCcIRa1er7zPx6igKHQM0YaVWrB5n5tYJk+n2hVBpsv1SpkwCGu2qQ6CD5SpkQbI2FDLwK5t8sonlb6+Pm3tQmBUFPrGMRjTKwp8uBKPxNpfYS8OlyOQPjhvAKgLsSwulFIYZum5w0fbLrtJQaZsAUc1qtnnO03jBXq90fBsF0CvwPQ3g1BXzU1nqnSeMkaHbjxjuta9fqAO7JCq89M2Pj0qWrLaU6sJH+Qhahkb/laH0gEWrhK/UjAdvy/nIlhMtDeoODaJfjuqbVoSnlISJ6uSBxLjhar5+rVO4LLaurcQNoh7QjaZYZ/EcwD4VEDzJgpkfuIeA9W+v9uUlTlPIENBi4N6OYkw5cXBRi0CSbL+UvINqSWhYFhV/0qFh+IQSejAr/OWL+Ig3YLvzC1pZEEp0n5nMMPALAYeAsAZ8tCvGheVmzWh0k5hM5ra281LylfAFLjbfgk2if47ofpyn5Su3CUrHH+06nWty8zW17PEl5EkSb8rOCDoTM3/RpfcbU6Gx//x2iVBphYB+Ax3OwdVvr4evjySjO1GoVEQQTmeOl25rZzjKXsIR6MxBiaO3k5Blz1wHwlTKT4btbuWIAeNrR+mjsQJeHEelXN/HSrEg2ATybJOt6YYyMwvt5NGiLUilNXg+E2BOHsSPRs6wlFuE3AGxYIauZEO/c9CKcNG6I56XcykQ7mXkLiAz5jVWfebq96jMfWeV5x7M27tjmvxkulN1QeOznAAAAAElFTkSuQmCC"},a5c6:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAiCAYAAAApkEs2AAAC40lEQVRYR+2YTWgTQRTH35uYlJbSBqPQ1osIVfBYPXhpFQoWBEWhl51dQmgPQo+CHwhaKiJ+3BQKHlKWdDN7EEXqSUUU9SQe9VCD6KHUHqzEUkGadP4yIZFWUjehSYqYOexumJf3fu+/bx8zw/SPDF7L6ThOv9b6LBEdBNC9FTkw8xcieiuEuOV53qsSw29QKeVFAFeJaB38VsCamMysieiSUupa4be5SCkHALwgohwzXxZCpDzPM5k1fDiO0621jgO4wszbhBBHjLIl0BkAx5n5glLqRsPpygSUUp4HcJ2ZHymlTpRA501NhkKhnq1S8k9Wo+zq6uq8qVmlVE8B1LIsmLvv+5uqT9u2BwHsUkqlavFW1nLVFFRK+ZGIdkcikZjrutnNwtYN1LIs8wF2tbS0dLuuu9AE3WyNNhX1fa7px9RU9L9XlJlvA/ixUXsSQrxLp9MqqH3Vs4/OEtHeIACzMopGo52Tk5PLf7OtG6jjOH0AhioAfe953kyQXd1AgwJXO98ErVaxIPumokEKVTvfVLRaxYLsyym6SETb29raYslk8luQg0bMx+PxWC6X+8rMi0qpHaXN3WMAR4UQo+l0eqoRIEExbNse0VonmfmJUmqoAGrb9rDW+h4RfWfmkd7e3ocTExPmAKDhY3x8XGQymZMAjGCdRDTs+/7937tOy7KSRDRSJFtm5or3PADmwuHw6VQq9WFtZlLKA0R0h4h2VpoxgC4iai/aT/m+P2qe122PpZQJAOeYeR8AUanzgiPmuVAoNDA9Pf2p+Jb2A3gJIFalHw1glplvKqXc0n/L7uPHxsbal5aWTGaVjJDW+i6Aw0T0WQjRL4QI5/P510TUY046hBBnKnFkbDo6OhbKrao2deBQCm4Sy2azTwEcYuYMEYUA7GHm55FI5Jjruj8rBd3IriagxnkikYiurKw8A9BXLIU30Wh0MGjNWWkCNQM1AU3vy+fzD8xza2vrqVr25F+ahcQywfNG0QAAAABJRU5ErkJggg=="},bbf1:function(e,t,i){},c3d7:function(e,t,i){},ca00:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("98e0"),i("ea69"),i("96db");var s=!0,n=!1,o=!0,a=function(e,t){var i=this,a=Array.from(arguments).splice(2);console.log(a),o&&(s&&(e.apply(this,a),s=!1),o=!1,setTimeout((function(){o=!0,n&&e.apply(i,a),s=!0,n=!s}),t))}},cf00:function(e,t,i){"use strict";var s=i("8ede"),n=i.n(s);n.a},ebcb:function(e,t,i){"use strict";i("4194"),i("fe59"),i("9302"),i("08ba");var s=i("5c62"),n=i("365c"),o=i("ca00");t["a"]={data:function(){return{}},methods:{findCrmBussiness:function(){var e=this,t=function(){var t=[];Object(n["b"])(e.keyWord).then((function(i){if(200==i.code){var o=i.data;if(o.length>0){o.forEach((function(e){t.push(e.customerId)}));var a=t.join(",");Object(n["c"])({customerIds:a}).then((function(t){for(var i=t.data,n=0;n<o.length;n++){o[n].phoneList=[];for(var a=0;a<i.length;a++)if(o[n].customerId==i[a].customerId){var c=i[a].phoneList.find((function(e){return"CUS_CONT_STATUS_2"===e.status}));o[n].mainContact=c.no,o[n].phoneList=Object(s["a"])(i[a].phoneList);break}}e.crmUsers=o,e.$forceUpdate()})),e.crmUsers=o}}}))};Object(o["a"])(t,1500)}}}},f4e3:function(e,t,i){"use strict";var s=i("b2a2"),n=i("857c"),o=i("d88d"),a=i("2732"),c=i("38eb"),l=i("59da");s("match",1,(function(e,t,i){return[function(t){var i=a(this),s=void 0==t?void 0:t[e];return void 0!==s?s.call(t,i):new RegExp(t)[e](String(i))},function(e){var s=i(t,e,this);if(s.done)return s.value;var a=n(e),r=String(this);if(!a.global)return l(a,r);var d=a.unicode;a.lastIndex=0;var m,f=[],u=0;while(null!==(m=l(a,r))){var p=String(m[0]);f[u]=p,""===p&&(a.lastIndex=c(r,o(a.lastIndex),d)),u++}return 0===u?null:f}]}))},f90e:function(e,t,i){"use strict";var s=i("8d72"),n=i.n(s);n.a},fec7:function(e,t,i){}}]);